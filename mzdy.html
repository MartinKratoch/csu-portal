<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ČSÚ · Mzdy & důchody</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0f14;
    --surface: #14171f;
    --surface2: #1c2030;
    --border: #252a3a;
    --accent: #e8c547;
    --accent2: #e85447;
    --accent3: #47c5e8;
    --accent4: #7c6af5;
    --text: #e8e4d8;
    --muted: #7a8099;
    --positive: #5ce87a;
    --c-mzda: #47c5e8;
    --c-cista: #7c6af5;
    --c-duchod: #e8c547;
    --c-nahrada: #5ce87a;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { background: var(--bg); color: var(--text); font-family: 'DM Mono', monospace; min-height: 100vh; overflow-x: hidden; }
  body::before {
    content: ''; position: fixed; inset: 0;
    background-image: linear-gradient(rgba(71,197,232,0.025) 1px, transparent 1px), linear-gradient(90deg, rgba(71,197,232,0.025) 1px, transparent 1px);
    background-size: 40px 40px; pointer-events: none; z-index: 0;
  }
  .container { position: relative; z-index: 1; max-width: 1100px; margin: 0 auto; padding: 48px 24px 80px; }

  /* NAV */
  .nav { display: flex; align-items: center; gap: 16px; margin-bottom: 48px; flex-wrap: wrap; }
  .nav-back { font-size: 10px; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); text-decoration: none; display: flex; align-items: center; gap: 6px; transition: color 0.15s; }
  .nav-back:hover { color: var(--accent3); }
  .nav-sep { color: var(--border); }
  .nav-current { font-size: 10px; letter-spacing: 0.1em; text-transform: uppercase; color: var(--accent3); }

  /* HEADER */
  .eyebrow { font-size: 10px; letter-spacing: 0.2em; text-transform: uppercase; color: var(--accent3); margin-bottom: 8px; }
  h1 { font-family: 'DM Serif Display', serif; font-size: clamp(36px, 6vw, 64px); line-height: 1.0; color: var(--text); margin-bottom: 12px; }
  h1 em { font-style: italic; color: var(--accent3); }
  .subtitle { font-size: 12px; color: var(--muted); letter-spacing: 0.05em; margin-bottom: 40px; }

  /* STAT CARDS */
  .stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin-bottom: 32px; }
  .stat-card { background: var(--surface); border: 1px solid var(--border); padding: 20px; position: relative; overflow: hidden; }
  .stat-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: var(--card-color, var(--accent3)); transform: scaleX(0); transform-origin: left; transition: transform 0.4s ease; }
  .stat-card.loaded::before { transform: scaleX(1); }
  .stat-label { font-size: 9px; letter-spacing: 0.15em; text-transform: uppercase; color: var(--muted); margin-bottom: 8px; }
  .stat-value { font-family: 'DM Serif Display', serif; font-size: 28px; line-height: 1; }
  .stat-sub { font-size: 10px; color: var(--muted); margin-top: 6px; }

  /* DATA NOTE */
  .data-note { font-size: 10px; color: var(--muted); background: var(--surface2); border: 1px solid var(--border); border-left: 2px solid var(--accent3); padding: 8px 14px; margin-bottom: 20px; line-height: 1.6; }
  .data-note strong { color: var(--accent3); }

  /* TABS */
  .tabs { display: flex; gap: 2px; margin-bottom: 28px; border-bottom: 1px solid var(--border); flex-wrap: wrap; }
  .tab { background: transparent; border: none; border-bottom: 2px solid transparent; color: var(--muted); padding: 10px 20px; font-family: 'DM Mono', monospace; font-size: 11px; letter-spacing: 0.08em; text-transform: uppercase; cursor: pointer; margin-bottom: -1px; transition: all 0.15s; }
  .tab:hover { color: var(--text); }
  .tab.active { color: var(--accent3); border-bottom-color: var(--accent3); }

  .panel { display: none; }
  .panel.active { display: block; }

  /* CHART */
  .chart-wrapper { background: var(--surface); border: 1px solid var(--border); padding: 24px; margin-bottom: 24px; }
  .chart-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 16px; flex-wrap: wrap; gap: 10px; }
  .chart-title { font-size: 11px; letter-spacing: 0.05em; color: var(--text); }
  .chart-legend { display: flex; gap: 16px; flex-wrap: wrap; }
  .legend-item { display: flex; align-items: center; gap: 5px; font-size: 10px; color: var(--muted); }
  .legend-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
  .legend-line { width: 18px; height: 2px; flex-shrink: 0; }

  /* CONTROLS */
  .controls { display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap; align-items: center; }
  .controls-label { font-size: 9px; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); margin-right: 4px; }
  .btn { background: var(--surface2); border: 1px solid var(--border); color: var(--muted); font-family: 'DM Mono', monospace; font-size: 10px; letter-spacing: 0.06em; padding: 6px 14px; cursor: pointer; transition: all 0.15s; }
  .btn:hover { border-color: var(--accent3); color: var(--accent3); }
  .btn.active { border-color: var(--accent3); color: var(--accent3); background: rgba(71,197,232,0.08); }

  /* TABLE */
  .table-section { background: var(--surface); border: 1px solid var(--border); }
  .table-header { padding: 14px 20px; font-size: 10px; letter-spacing: 0.08em; text-transform: uppercase; color: var(--muted); border-bottom: 1px solid var(--border); }
  .table-scroll { overflow-x: auto; }
  table { width: 100%; border-collapse: collapse; font-size: 11px; font-variant-numeric: tabular-nums; }
  thead tr { background: var(--surface2); }
  th { text-align: left; padding: 9px 16px; font-size: 9px; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); font-weight: 400; border-bottom: 1px solid var(--border); white-space: nowrap; }
  td { padding: 8px 16px; border-bottom: 1px solid rgba(37,42,58,0.5); white-space: nowrap; }
  tr:hover td { background: rgba(71,197,232,0.03); }
  tr.highlight-row td { background: rgba(71,197,232,0.06); }
  .td-year { color: var(--muted); }
  .td-mzda { color: var(--c-mzda); }
  .td-cista { color: var(--c-cista); }
  .td-duchod { color: var(--c-duchod); }
  .td-nahrada { color: var(--c-nahrada); }
  .td-muted { color: var(--muted); }
  .td-delta-pos { color: var(--positive); }
  .td-delta-neg { color: var(--accent2); }

  /* REÁLNÉ HODNOTY PANEL */
  .real-top { background: var(--surface); border: 1px solid var(--border); border-left: 2px solid var(--accent3); padding: 16px 20px; margin-bottom: 20px; display: flex; align-items: center; gap: 20px; flex-wrap: wrap; }
  .real-input-group { display: flex; align-items: center; gap: 10px; }
  .real-input-label { font-size: 9px; letter-spacing: 0.12em; text-transform: uppercase; color: var(--muted); }
  .real-input { background: var(--surface2); border: 1px solid var(--border); color: var(--text); font-family: 'DM Mono', monospace; font-size: 18px; padding: 6px 12px; width: 90px; text-align: center; outline: none; transition: border-color 0.15s; }
  .real-input:focus { border-color: var(--accent3); }
  .real-desc { font-size: 11px; color: var(--muted); line-height: 1.6; flex: 1; min-width: 200px; }
  .real-desc strong { color: var(--text); }

  /* NÁHRADOVÝ POMĚR */
  .nahrada-note { font-size: 11px; color: var(--muted); background: var(--surface2); border: 1px solid var(--border); padding: 12px 16px; margin-bottom: 20px; line-height: 1.65; }
  .nahrada-note strong { color: var(--text); }

  /* KALKULAČKA */
  .calc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px; }
  @media (max-width: 650px) { .calc-grid { grid-template-columns: 1fr; } }
  .calc-card { background: var(--surface); border: 1px solid var(--border); padding: 24px; }
  .calc-card h3 { font-size: 12px; letter-spacing: 0.08em; text-transform: uppercase; color: var(--text); margin-bottom: 16px; }
  .input-row { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
  .input-label { font-size: 10px; color: var(--muted); min-width: 120px; }
  .calc-input { background: var(--surface2); border: 1px solid var(--border); color: var(--text); font-family: 'DM Mono', monospace; font-size: 14px; padding: 7px 12px; flex: 1; outline: none; transition: border-color 0.15s; }
  .calc-input:focus { border-color: var(--accent3); }
  .calc-btn { background: rgba(71,197,232,0.1); border: 1px solid var(--accent3); color: var(--accent3); font-family: 'DM Mono', monospace; font-size: 10px; letter-spacing: 0.1em; text-transform: uppercase; padding: 10px 20px; cursor: pointer; transition: all 0.15s; width: 100%; margin-top: 8px; }
  .calc-btn:hover { background: rgba(71,197,232,0.18); }
  .calc-result { background: var(--surface); border: 1px solid var(--border); padding: 20px; }
  .calc-result h3 { font-size: 10px; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); margin-bottom: 16px; }
  .result-row { display: flex; justify-content: space-between; align-items: baseline; padding: 8px 0; border-bottom: 1px solid rgba(37,42,58,0.5); font-size: 11px; }
  .result-row:last-child { border-bottom: none; }
  .result-label { color: var(--muted); }
  .result-val { font-family: 'DM Serif Display', serif; font-size: 18px; }
  .err { font-size: 10px; color: var(--accent2); margin-top: 8px; }

  /* LOADING */
  .loading { display: flex; align-items: center; gap: 12px; padding: 40px; color: var(--muted); font-size: 11px; }
  .spinner { width: 16px; height: 16px; border: 2px solid var(--border); border-top-color: var(--accent3); border-radius: 50%; animation: spin 0.8s linear infinite; }
  @keyframes spin { to { transform: rotate(360deg); } }

  footer { margin-top: 60px; border-top: 1px solid var(--border); padding-top: 20px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; font-size: 10px; color: var(--muted); }
  footer a { color: var(--muted); text-decoration: none; }
  footer a:hover { color: var(--accent3); }
</style>
</head>
<body>
<div class="container">

  <nav class="nav">
    <a href="index.html" class="nav-back">← Portál</a>
    <span class="nav-sep">/</span>
    <span class="nav-current">Mzdy &amp; důchody</span>
  </nav>

  <div class="eyebrow">Český statistický úřad · Trh práce &amp; sociální statistiky</div>
  <h1>Mzdy<br>&amp; <em>důchody</em></h1>
  <div class="subtitle">Průměrná mzda · Průměrný důchod · Náhradový poměr · Česká republika 1993–2024</div>

  <!-- STAT CARDS -->
  <div class="stats-row">
    <div class="stat-card" id="card-mzda" style="--card-color: var(--c-mzda)">
      <div class="stat-label">Průměrná hrubá mzda</div>
      <div class="stat-value" id="val-mzda" style="color:var(--c-mzda)">—</div>
      <div class="stat-sub" id="sub-mzda">načítám…</div>
    </div>
    <div class="stat-card" id="card-cista" style="--card-color: var(--c-cista)">
      <div class="stat-label">Čistá mzda (odhad)</div>
      <div class="stat-value" id="val-cista" style="color:var(--c-cista)">—</div>
      <div class="stat-sub" id="sub-cista">po odvodech a dani</div>
    </div>
    <div class="stat-card" id="card-duchod" style="--card-color: var(--c-duchod)">
      <div class="stat-label">Průměrný starobní důchod</div>
      <div class="stat-value" id="val-duchod" style="color:var(--c-duchod)">—</div>
      <div class="stat-sub" id="sub-duchod">načítám…</div>
    </div>
    <div class="stat-card" id="card-nahrada" style="--card-color: var(--c-nahrada)">
      <div class="stat-label">Náhradový poměr</div>
      <div class="stat-value" id="val-nahrada" style="color:var(--c-nahrada)">—</div>
      <div class="stat-sub" id="sub-nahrada">důchod / čistá mzda</div>
    </div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab active" onclick="switchTab('nominalni',this)">Nominální vývoj</button>
    <button class="tab" onclick="switchTab('realne',this)">Reálné hodnoty</button>
    <button class="tab" onclick="switchTab('nahrada',this)">Náhradový poměr</button>
    <button class="tab" onclick="switchTab('median',this)">Průměr vs. medián</button>
    <button class="tab" onclick="switchTab('kalkulator',this)">Kalkulátor</button>
  </div>

  <!-- PANEL: NOMINÁLNÍ -->
  <div class="panel active" id="panel-nominalni">

    <div class="data-note">
      <strong>Průměrná hrubá mzda</strong>: ČSÚ výkaznictví, přepočtené počty zaměstnanců, národní hospodářství celkem.
      <strong>Čistá mzda</strong>: dopočet dle historických sazeb daně z příjmu a pojistného (±3 % od skutečnosti).
      <strong>Průměrný starobní důchod</strong>: ČSSZ, prosincové hodnoty, sólo důchody bez souběhu.
    </div>

    <div class="controls">
      <span class="controls-label">Zobrazit:</span>
      <button class="btn active" onclick="setNomRange('all',this)">Vše (1993–)</button>
      <button class="btn" onclick="setNomRange(20,this)">20 let</button>
      <button class="btn" onclick="setNomRange(10,this)">10 let</button>
      <button class="btn" onclick="setNomRange(5,this)">5 let</button>
    </div>

    <div class="chart-wrapper">
      <div class="chart-header">
        <div class="chart-title">Průměrná hrubá mzda, čistá mzda a starobní důchod (Kč/měsíc)</div>
        <div class="chart-legend">
          <div class="legend-item"><span class="legend-line" style="background:var(--c-mzda)"></span>Hrubá mzda</div>
          <div class="legend-item"><span class="legend-line" style="background:var(--c-cista);border-top:2px dashed var(--c-cista);height:0"></span>Čistá mzda</div>
          <div class="legend-item"><span class="legend-line" style="background:var(--c-duchod)"></span>Důchod</div>
        </div>
      </div>
      <div id="loading-nom" class="loading"><div class="spinner"></div><span>Načítám…</span></div>
      <canvas id="chartNom" style="display:none"></canvas>
    </div>

    <div class="table-section">
      <div class="table-header">Detailní přehled po letech</div>
      <div class="table-scroll">
        <table>
          <thead><tr>
            <th>Rok</th>
            <th>Hrubá mzda</th>
            <th>Δ hrubá</th>
            <th>Čistá mzda</th>
            <th>Důchod</th>
            <th>Δ důchod</th>
            <th>Náhradový poměr (čistá)</th>
          </tr></thead>
          <tbody id="tableNom"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- PANEL: REÁLNÉ HODNOTY -->
  <div class="panel" id="panel-realne">

    <div class="real-top">
      <div class="real-input-group">
        <span class="real-input-label">Srovnávací rok</span>
        <input type="number" class="real-input" id="realBaseYear" value="2024" min="1993" max="2024" oninput="renderRealne()" />
      </div>
      <p class="real-desc">
        Hodnoty jsou přepočteny inflátorem z modulu Inflace do konstantních cen
        <strong>zvoleného roku</strong>. Umožňuje srovnat kupní sílu mzdy a důchodu
        v různých obdobích bez zkreslení nominálním růstem cen.
      </p>
    </div>

    <div class="chart-wrapper">
      <div class="chart-header">
        <div class="chart-title">Reálná kupní síla — hodnoty v cenách zvoleného roku (Kč/měsíc)</div>
        <div class="chart-legend">
          <div class="legend-item"><span class="legend-line" style="background:var(--c-mzda)"></span>Hrubá mzda (reálná)</div>
          <div class="legend-item"><span class="legend-line" style="background:var(--c-cista)"></span>Čistá mzda (reálná)</div>
          <div class="legend-item"><span class="legend-line" style="background:var(--c-duchod)"></span>Důchod (reálný)</div>
        </div>
      </div>
      <canvas id="chartReal"></canvas>
    </div>

    <div class="table-section">
      <div class="table-header">Reálné hodnoty v cenách roku <span id="realBaseLabel">2024</span></div>
      <div class="table-scroll">
        <table>
          <thead><tr>
            <th>Rok</th>
            <th>Inflace</th>
            <th>Deflátorový koef.</th>
            <th>Hrubá mzda nom.</th>
            <th>Hrubá mzda reál.</th>
            <th>Čistá mzda nom.</th>
            <th>Čistá mzda reál.</th>
            <th>Důchod nom.</th>
            <th>Důchod reál.</th>
          </tr></thead>
          <tbody id="tableReal"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- PANEL: NÁHRADOVÝ POMĚR -->
  <div class="panel" id="panel-nahrada">

    <div class="nahrada-note">
      <strong>Náhradový poměr</strong> = průměrný starobní důchod / průměrná čistá mzda × 100.
      V českém kontextu je toto srovnání přirozenější — <strong>důchody nejsou zdaněny</strong>, jde tedy o čistý příjem, zatímco ze mzdy zaměstnanec odvádí daň z příjmu a pojistné. Poměr vůči čisté mzdě lépe odráží skutečné nahrazení životní úrovně.
      Evropská komise standardně sleduje poměr vůči hrubé mzdě (~45 %), vůči čisté mzdě vychází hodnota výrazně příznivěji (~65 %).
    </div>

    <div class="chart-wrapper">
      <div class="chart-header">
        <div class="chart-title">Náhradový poměr — důchod jako % průměrné čisté mzdy</div>
        <div class="chart-legend">
          <div class="legend-item"><span class="legend-line" style="background:var(--c-nahrada)"></span>Náhradový poměr (%)</div>
          <div class="legend-item">
            <svg width="18" height="6"><line x1="0" y1="3" x2="18" y2="3" stroke="rgba(122,128,153,0.6)" stroke-width="1.5" stroke-dasharray="4,3"/></svg>
            průměr období
          </div>
        </div>
      </div>
      <canvas id="chartNahrada"></canvas>
    </div>

    <div class="table-section">
      <div class="table-header">Vývoj náhradového poměru po letech</div>
      <div class="table-scroll">
        <table>
          <thead><tr>
            <th>Rok</th>
            <th>Hrubá mzda</th>
            <th>Čistá mzda</th>
            <th>Důchod</th>
            <th>Náhradový poměr (čistá)</th>
            <th>Δ oproti předchozímu roku</th>
          </tr></thead>
          <tbody id="tableNahrada"></tbody>
        </table>
      </div>
    </div>
  </div>


  <!-- PANEL: PRŮMĚR vs. MEDIÁN -->
  <div class="panel" id="panel-median">

    <div class="data-note">
      <strong>Medián</strong>: mzda zaměstnance uprostřed mzdového rozdělení — polovina zaměstnanců bere méně, polovina více.
      Na rozdíl od průměru není zkreslena extrémně vysokými příjmy. <strong>Dvě třetiny zaměstnanců</strong> pobírají méně
      než průměrná mzda. Data z ISPV/ČSÚ strukturální výdělkové statistiky, dostupná od roku 2002.
      Hodnoty za roky 2002–2019 jsou přibližné odhady z pololetních výsledků ISPV a analýz ČNB.
    </div>

    <div class="chart-wrapper">
      <div class="chart-header">
        <div class="chart-title">Průměrná vs. mediánová čistá měsíční mzda (Kč)</div>
        <div class="chart-legend">
          <div class="legend-item"><span class="legend-line" style="background:var(--c-cista)"></span>Čistá průměrná mzda</div>
          <div class="legend-item"><span class="legend-line" style="background:var(--accent)"></span>Čistá mediánová mzda</div>
          <div class="legend-item"><span class="legend-line" style="background:rgba(122,128,153,0.5);width:30px;border-top:2px dashed rgba(122,128,153,0.5);height:0"></span>Medián jako % průměru (osa vpravo)</div>
        </div>
      </div>
      <canvas id="chartMedian"></canvas>
    </div>

    <div class="table-section">
      <div class="table-header">Průměr a medián — přehled po letech</div>
      <div class="table-scroll">
        <table>
          <thead><tr>
            <th>Rok</th>
            <th>Hrubá průměrná</th>
            <th>Čistá průměrná</th>
            <th>Hrubá mediánová</th>
            <th>Čistá mediánová</th>
            <th>Medián / průměr</th>
            <th>Rozdíl čisté (průměr − medián)</th>
          </tr></thead>
          <tbody id="tableMedian"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- PANEL: KALKULÁTOR -->
  <div class="panel" id="panel-kalkulator">

    <div class="data-note">
      Zadej rok a hrubou mzdu — kalkulátor ukáže čistou mzdu, porovnání s průměrem,
      ekvivalentní důchod tehdy, a reálnou hodnotu v dnešních cenách.
    </div>

    <div class="calc-grid">
      <div class="calc-card">
        <h3>Vstupní údaje</h3>
        <div class="input-row">
          <span class="input-label">Rok</span>
          <input type="number" class="calc-input" id="calcYear" value="2000" min="1993" max="2024" />
        </div>
        <div class="input-row">
          <span class="input-label">Hrubá mzda (Kč)</span>
          <input type="number" class="calc-input" id="calcHrubo" value="13000" step="500" />
        </div>
        <button class="calc-btn" onclick="runCalc()">Spočítat</button>
        <div class="err" id="calcErr" style="display:none"></div>
      </div>

      <div class="calc-card" id="calcResultCard" style="display:none">
        <h3>Výsledky</h3>
        <div id="calcResults"></div>
      </div>
    </div>

    <div class="table-section" id="calcContext" style="display:none">
      <div class="table-header">Kontext — průměrné hodnoty v zadaném roce</div>
      <div class="table-scroll">
        <table>
          <thead><tr><th>Ukazatel</th><th>Nominální (Kč)</th><th>Reálná hodnota (v cenách 2024)</th></tr></thead>
          <tbody id="calcContextTable"></tbody>
        </table>
      </div>
    </div>

  </div>

  <footer>
    <span>Mzdy: <a href="https://csu.gov.cz" target="_blank">ČSÚ</a> · Důchody: <a href="https://www.cssz.cz" target="_blank">ČSSZ</a> · Inflátor: modul Inflace (data.csu.gov.cz)</span>
    <span id="lastUpdate"></span>
  </footer>

</div>

<script>
// ══════════════════════════════════════════════════════
// DATA
// ══════════════════════════════════════════════════════

// Průměrná roční inflace (z modulu inflace) — pro deflátorové výpočty
const INFLACE = {
  1990:9.7,1991:56.6,1992:11.1,1993:20.8,1994:10.0,1995:9.1,1996:8.8,1997:8.5,
  1998:10.7,1999:2.1,2000:3.9,2001:4.7,2002:1.8,2003:0.1,2004:2.8,2005:1.9,
  2006:2.5,2007:2.8,2008:6.3,2009:1.0,2010:1.5,2011:1.9,2012:3.3,2013:1.4,
  2014:0.4,2015:0.3,2016:0.7,2017:2.5,2018:2.1,2019:2.8,2020:3.2,2021:3.8,
  2022:15.1,2023:10.7,2024:2.4,2025:2.5
};

// Průměrná hrubá měsíční mzda (Kč) — ČSÚ výkaznictví
const MZDA = {
  1993:5817,1994:6894,1995:8172,1996:9825,1997:10802,1998:11693,1999:12797,
  2000:13219,2001:14378,2002:15524,2003:16430,2004:17466,2005:18344,2006:19546,
  2007:20957,2008:22691,2009:23344,2010:23864,2011:24455,2012:25101,2013:25128,
  2014:25686,2015:26467,2016:27764,2017:29504,2018:32040,2019:34125,2020:35441,
  2021:37839,2022:40353,2023:43685,2024:46165,
  2025:48171  // předběžný odhad — průměr 1.–3. čtvrtletí 2025 (ČSÚ), roční finální data v 3/2026
};

// Průměrný starobní důchod (Kč/měsíc) — ČSSZ prosincové hodnoty
// 1993: MPSV "Vývoj vybraných ukazatelů životní úrovně v ČR" — průměr roku
// 1994+: ČSSZ prosincové hodnoty sólo starobních důchodů
const DUCHOD = {
  1993:2734,
  1994:2899,1995:3488,1996:4116,1997:4725,1998:5222,1999:5667,
  2000:6078,2001:6352,2002:6858,2003:7022,2004:7279,2005:7728,
  2006:8178,2007:8809,2008:9648,2009:10217,2010:10459,2011:10731,
  2012:11268,2013:11353,2014:11396,2015:11451,2016:11691,2017:12202,
  2018:13191,2019:14027,2020:14792,2021:15248,2022:18582,2023:19963,2024:20736
};


// Medián hrubé měsíční mzdy (Kč) — ČSÚ strukturální výdělkové statistiky / ISPV
// Dostupné od roku 2002 (zahájení ISPV šetření). Starší data nejsou k dispozici.
// 2024: 41 742 Kč (ČSÚ strukturální statistika, zveřejněno 2025)
// 2023: 39 527 Kč (ČSÚ/ISPV roční výsledky)
// Starší hodnoty: přibližné odhady z ISPV pololetních výsledků a ČNB analýz
const MEDIAN_HRUBO = {
  2002:12200,2003:12700,2004:13400,2005:14000,2006:14900,2007:16200,
  2008:17800,2009:18700,2010:19600,2011:20400,2012:21200,2013:21500,
  2014:22100,2015:22800,2016:23700,2017:25200,2018:27200,2019:28900,
  2020:30265,2021:33400,2022:35200,2023:39527,2024:41742
};

// Historické efektivní sazby pro dopočet čisté mzdy
// Odráží změny sazeb daně z příjmu (15/19/20-25%), slev a pojistného
function hrubaToCista(rok, hrubo) {
  let rate;
  if (rok < 1996) rate = 0.655;
  else if (rok < 2000) rate = 0.660;
  else if (rok < 2006) rate = 0.665;
  else if (rok < 2008) rate = 0.670;
  else if (rok < 2013) rate = 0.678;
  else if (rok < 2021) rate = 0.684;
  else rate = 0.690;
  return Math.round(hrubo * rate);
}

// Kumulativní cenová hladina (base = 1993)
const PRICE_LEVEL = {};
(function() {
  let cum = 1.0;
  const years = Object.keys(INFLACE).map(Number).sort();
  PRICE_LEVEL[years[0]] = 1.0;
  for (let i = 1; i < years.length; i++) {
    cum *= (1 + INFLACE[years[i]] / 100);
    PRICE_LEVEL[years[i]] = cum;
  }
})();

function defCoeff(year, baseYear) {
  return (PRICE_LEVEL[baseYear] || 1) / (PRICE_LEVEL[year] || 1);
}

// ══════════════════════════════════════════════════════
// INIT
// ══════════════════════════════════════════════════════
const YEARS_MZDA = Object.keys(MZDA).map(Number).sort();
const YEARS_BOTH = YEARS_MZDA.filter(y => DUCHOD[y]);
const YEARS_MEDIAN = Object.keys(MEDIAN_HRUBO).map(Number).sort();

let nomRange = 'all';
let chartNom = null, chartReal = null, chartNahrada = null;

function fmt(n) { return n.toLocaleString('cs-CZ') + ' Kč'; }
function fmtPct(n) { return n.toFixed(1).replace('.',',') + ' %'; }
function delta(cur, prev) {
  if (!prev) return null;
  return ((cur - prev) / prev * 100);
}

function init() {
  fillStatCards();
  renderNom();
  renderNahradaChart();
  renderNahradaTable();
  renderRealne();
  renderMedian();
  document.getElementById('lastUpdate').textContent =
    'Aktualizováno: ' + new Date().toLocaleDateString('cs-CZ', {day:'numeric',month:'long',year:'numeric'});
}

function fillStatCards() {
  // Pro mzdu použijeme poslední dostupný rok (může být 2025 - předběžný)
  const lastYearMzda = YEARS_MZDA.at(-1);
  const lastMzda = MZDA[lastYearMzda];
  const lastCista = hrubaToCista(lastYearMzda, lastMzda);
  // Pro důchod a náhradový poměr použijeme poslední rok, kde máme DUCHOD
  const lastYearDuchod = YEARS_BOTH.at(-1);
  const lastDuchod = DUCHOD[lastYearDuchod];
  const lastCistaDuchod = hrubaToCista(lastYearDuchod, MZDA[lastYearDuchod]);
  const lastNahrada = lastDuchod / lastCistaDuchod * 100;

  const sc = (id, val, sub) => {
    document.getElementById('val-'+id).textContent = val;
    document.getElementById('sub-'+id).textContent = sub;
    document.getElementById('card-'+id).classList.add('loaded');
  };
  sc('mzda', fmt(lastMzda), `Rok ${lastYearMzda}${lastYearMzda===2025?' (předběžný průměr 1.–3.Q)':''} · +${delta(lastMzda, MZDA[lastYearMzda-1]).toFixed(1)} % meziročně`);
  sc('cista', fmt(lastCista), `≈ ${fmtPct(lastCista/lastMzda*100)} z hrubé`);
  sc('duchod', fmt(lastDuchod), `Rok ${lastYearDuchod} · ČSSZ prosinec`);
  sc('nahrada', fmtPct(lastNahrada), `${lastYearDuchod}: důchod / čistá mzda`);
}

// ══════════════════════════════════════════════════════
// TAB 1: NOMINÁLNÍ
// ══════════════════════════════════════════════════════
function setNomRange(range, btn) {
  document.querySelectorAll('.controls .btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  nomRange = range;
  renderNom();
}

function getNomFiltered() {
  if (nomRange === 'all') return YEARS_MZDA;
  const last = YEARS_MZDA.at(-1);
  return YEARS_MZDA.filter(y => y >= last - nomRange + 1);
}

function renderNom() {
  const years = getNomFiltered();
  document.getElementById('loading-nom').style.display = 'none';
  const cv = document.getElementById('chartNom');
  cv.style.display = 'block';

  const mzdaVals = years.map(y => MZDA[y]);
  const cistaVals = years.map(y => hrubaToCista(y, MZDA[y]));
  const duchodVals = years.map(y => DUCHOD[y] || null);

  if (chartNom) chartNom.destroy();
  chartNom = new Chart(cv, {
    type: 'line',
    data: {
      labels: years.map(String),
      datasets: [
        {
          label: 'Hrubá mzda',
          data: mzdaVals,
          borderColor: 'rgba(71,197,232,0.9)',
          backgroundColor: 'rgba(71,197,232,0.06)',
          borderWidth: 2,
          pointRadius: 3, pointHoverRadius: 6,
          pointBackgroundColor: 'rgba(71,197,232,0.9)',
          fill: false, tension: 0.3, order: 1,
        },
        {
          label: 'Čistá mzda',
          data: cistaVals,
          borderColor: 'rgba(124,106,245,0.8)',
          backgroundColor: 'transparent',
          borderWidth: 1.5, borderDash: [5,3],
          pointRadius: 2, pointHoverRadius: 5,
          pointBackgroundColor: 'rgba(124,106,245,0.8)',
          fill: false, tension: 0.3, order: 2,
        },
        {
          label: 'Průměrný důchod',
          data: duchodVals,
          borderColor: 'rgba(232,197,71,0.85)',
          backgroundColor: 'rgba(232,197,71,0.05)',
          borderWidth: 2,
          pointRadius: 3, pointHoverRadius: 6,
          pointBackgroundColor: 'rgba(232,197,71,0.85)',
          fill: false, tension: 0.3, order: 3,
        },
      ]
    },
    options: chartOpts('Kč/měsíc', v => v.toLocaleString('cs-CZ') + ' Kč')
  });

  renderNomTable(years);
}

function renderNomTable(years) {
  const tbody = document.getElementById('tableNom');
  tbody.innerHTML = '';
  const lastY = years.at(-1);
  [...years].reverse().forEach(y => {
    const mz = MZDA[y];
    const ci = hrubaToCista(y, mz);
    const du = DUCHOD[y];
    const dMz = delta(mz, MZDA[y-1]);
    const dDu = du ? delta(du, DUCHOD[y-1]) : null;
    const nah = du ? (du / hrubaToCista(y, mz) * 100) : null;
    const tr = document.createElement('tr');
    if (y === lastY) tr.className = 'highlight-row';
    tr.innerHTML = `
      <td class="td-year">${y}</td>
      <td class="td-mzda">${mz.toLocaleString('cs-CZ')}</td>
      <td class="${dMz >= 0 ? 'td-delta-pos' : 'td-delta-neg'}">${dMz !== null ? (dMz > 0 ? '+' : '') + dMz.toFixed(1).replace('.',',') + ' %' : '—'}</td>
      <td class="td-cista">${ci.toLocaleString('cs-CZ')}</td>
      <td class="td-duchod">${du ? du.toLocaleString('cs-CZ') : '—'}</td>
      <td class="${dDu >= 0 ? 'td-delta-pos' : 'td-delta-neg'}">${dDu !== null ? (dDu > 0 ? '+' : '') + dDu.toFixed(1).replace('.',',') + ' %' : '—'}</td>
      <td class="td-nahrada">${nah ? fmtPct(nah) : '—'}</td>
    `;
    tbody.appendChild(tr);
  });
}

// ══════════════════════════════════════════════════════
// TAB 2: REÁLNÉ HODNOTY
// ══════════════════════════════════════════════════════
function renderRealne() {
  const baseYear = parseInt(document.getElementById('realBaseYear').value) || 2024;
  const clampedBase = Math.max(1993, Math.min(2024, baseYear));
  document.getElementById('realBaseLabel').textContent = clampedBase;

  const years = YEARS_BOTH;
  const realMzda = years.map(y => Math.round(MZDA[y] * defCoeff(y, clampedBase)));
  const realCista = years.map(y => Math.round(hrubaToCista(y, MZDA[y]) * defCoeff(y, clampedBase)));
  const realDuchod = years.map(y => Math.round(DUCHOD[y] * defCoeff(y, clampedBase)));

  if (chartReal) chartReal.destroy();
  const cv = document.getElementById('chartReal');
  chartReal = new Chart(cv, {
    type: 'line',
    data: {
      labels: years.map(String),
      datasets: [
        {
          label: 'Hrubá mzda (reálná)',
          data: realMzda,
          borderColor: 'rgba(71,197,232,0.9)',
          backgroundColor: 'rgba(71,197,232,0.05)',
          borderWidth: 2, fill: true, tension: 0.3,
          pointRadius: 3, pointHoverRadius: 6,
        },
        {
          label: 'Čistá mzda (reálná)',
          data: realCista,
          borderColor: 'rgba(124,106,245,0.9)',
          backgroundColor: 'rgba(124,106,245,0.05)',
          borderWidth: 2, fill: true, tension: 0.3,
          pointRadius: 3, pointHoverRadius: 6,
        },
        {
          label: 'Důchod (reálný)',
          data: realDuchod,
          borderColor: 'rgba(232,197,71,0.85)',
          backgroundColor: 'rgba(232,197,71,0.04)',
          borderWidth: 2, fill: true, tension: 0.3,
          pointRadius: 3, pointHoverRadius: 6,
        },
      ]
    },
    options: chartOpts(`Kč/${clampedBase}`, v => v.toLocaleString('cs-CZ') + ' Kč')
  });

  // Table
  const tbody = document.getElementById('tableReal');
  tbody.innerHTML = '';
  [...years].reverse().forEach(y => {
    const coeff = defCoeff(y, clampedBase);
    const mzNom = MZDA[y];
    const ciNom = hrubaToCista(y, mzNom);
    const duNom = DUCHOD[y];
    const mzReal = Math.round(mzNom * coeff);
    const ciReal = Math.round(ciNom * coeff);
    const duReal = Math.round(duNom * coeff);
    const infl = INFLACE[y];
    const tr = document.createElement('tr');
    if (y === clampedBase) tr.className = 'highlight-row';
    tr.innerHTML = `
      <td class="td-year">${y}${y === clampedBase ? ' ★' : ''}</td>
      <td class="td-muted">${infl !== undefined ? (infl > 0 ? '+' : '') + infl.toFixed(1).replace('.',',') + ' %' : '—'}</td>
      <td class="td-muted">${coeff.toFixed(4).replace('.',',')}</td>
      <td class="td-mzda">${mzNom.toLocaleString('cs-CZ')}</td>
      <td class="td-mzda">${mzReal.toLocaleString('cs-CZ')}</td>
      <td class="td-cista">${ciNom.toLocaleString('cs-CZ')}</td>
      <td class="td-cista">${ciReal.toLocaleString('cs-CZ')}</td>
      <td class="td-duchod">${duNom.toLocaleString('cs-CZ')}</td>
      <td class="td-duchod">${duReal.toLocaleString('cs-CZ')}</td>
    `;
    tbody.appendChild(tr);
  });
}

// ══════════════════════════════════════════════════════
// TAB 3: NÁHRADOVÝ POMĚR
// ══════════════════════════════════════════════════════
function renderNahradaChart() {
  const years = YEARS_BOTH.filter(y => MZDA[y] && DUCHOD[y]);
  const ratios = years.map(y => +(DUCHOD[y] / hrubaToCista(y, MZDA[y]) * 100).toFixed(2));
  const avg = ratios.reduce((a,b) => a+b, 0) / ratios.length;

  const cv = document.getElementById('chartNahrada');
  if (chartNahrada) chartNahrada.destroy();
  chartNahrada = new Chart(cv, {
    type: 'line',
    data: {
      labels: years.map(String),
      datasets: [
        {
          label: 'Náhradový poměr',
          data: ratios,
          borderColor: 'rgba(92,232,122,0.9)',
          backgroundColor: 'rgba(92,232,122,0.07)',
          borderWidth: 2, fill: true, tension: 0.3,
          pointRadius: 4, pointHoverRadius: 7,
          pointBackgroundColor: ratios.map(v =>
            v >= 45 ? 'rgba(92,232,122,1)' : v >= 43 ? 'rgba(232,197,71,1)' : 'rgba(232,84,71,1)'
          ),
        },
        {
          label: 'Průměr',
          data: years.map(() => avg),
          borderColor: 'rgba(122,128,153,0.5)',
          borderWidth: 1, borderDash: [5,3],
          pointRadius: 0, fill: false,
        }
      ]
    },
    options: (() => {
      const o = chartOpts('%', v => v.toFixed(1).replace('.',',') + ' %');
      o.scales.y.min = 0;
      return o;
    })()
  });
}

function renderNahradaTable() {
  const years = YEARS_BOTH;
  const tbody = document.getElementById('tableNahrada');
  tbody.innerHTML = '';
  [...years].reverse().forEach(y => {
    const mz = MZDA[y];
    const du = DUCHOD[y];
    const ratio = du / hrubaToCista(y, mz) * 100;
    const prevRatio = DUCHOD[y-1] && MZDA[y-1] ? DUCHOD[y-1] / hrubaToCista(y-1, MZDA[y-1]) * 100 : null;
    const d = prevRatio ? ratio - prevRatio : null;
    const tr = document.createElement('tr');
    const ci = hrubaToCista(y, mz);
    tr.innerHTML = `
      <td class="td-year">${y}</td>
      <td class="td-mzda">${mz.toLocaleString('cs-CZ')}</td>
      <td class="td-cista">${ci.toLocaleString('cs-CZ')}</td>
      <td class="td-duchod">${du.toLocaleString('cs-CZ')}</td>
      <td class="td-nahrada">${fmtPct(ratio)}</td>
      <td class="${d === null ? '' : d >= 0 ? 'td-delta-pos' : 'td-delta-neg'}">${d !== null ? (d > 0 ? '+' : '') + d.toFixed(2).replace('.',',') + ' p.b.' : '—'}</td>
    `;
    tbody.appendChild(tr);
  });
}

// ══════════════════════════════════════════════════════
// TAB 4: KALKULÁTOR
// ══════════════════════════════════════════════════════
function runCalc() {
  const y = parseInt(document.getElementById('calcYear').value);
  const hrubo = parseInt(document.getElementById('calcHrubo').value);
  const errEl = document.getElementById('calcErr');
  errEl.style.display = 'none';

  if (!MZDA[y]) { errEl.textContent = 'Rok mimo rozsah dat (1993–2024).'; errEl.style.display = 'block'; return; }
  if (isNaN(hrubo) || hrubo < 1000) { errEl.textContent = 'Zadej platnou hrubou mzdu.'; errEl.style.display = 'block'; return; }

  const cista = hrubaToCista(y, hrubo);
  const avgMzda = MZDA[y];
  const avgDuchod = DUCHOD[y];
  const avgCista = hrubaToCista(y, avgMzda);
  const nahrada = avgDuchod ? avgDuchod / avgCista * 100 : null;
  const coeff2024 = defCoeff(y, 2024);
  const pctAvg = hrubo / avgMzda * 100;

  const rows = [
    { label: `Hrubá mzda ${y}`, val: fmt(hrubo), valReal: fmt(Math.round(hrubo * coeff2024)), color: 'var(--c-mzda)' },
    { label: `Čistá mzda ${y}`, val: fmt(cista), valReal: fmt(Math.round(cista * coeff2024)), color: 'var(--c-cista)' },
    { label: `% průměrné mzdy`, val: fmtPct(pctAvg), valReal: '—', color: 'var(--muted)' },
    { label: `Průměrná mzda ${y}`, val: fmt(avgMzda), valReal: fmt(Math.round(avgMzda * coeff2024)), color: 'var(--c-mzda)' },
    ...(avgDuchod ? [{ label: `Průměrný důchod ${y}`, val: fmt(avgDuchod), valReal: fmt(Math.round(avgDuchod * coeff2024)), color: 'var(--c-duchod)' }] : []),
    ...(nahrada ? [{ label: `Náhradový poměr ${y} (důchod/čistá)`, val: fmtPct(nahrada), valReal: '—', color: 'var(--c-nahrada)' }] : []),
  ];

  const resultCard = document.getElementById('calcResultCard');
  const resultsEl = document.getElementById('calcResults');
  resultsEl.innerHTML = rows.map(r => `
    <div class="result-row">
      <span class="result-label">${r.label}</span>
      <span class="result-val" style="color:${r.color}">${r.val}</span>
    </div>
  `).join('');
  resultCard.style.display = 'block';

  // Context table
  const ctx = document.getElementById('calcContext');
  const ctxTable = document.getElementById('calcContextTable');
  ctxTable.innerHTML = rows.map(r => `
    <tr>
      <td class="td-muted">${r.label}</td>
      <td style="color:${r.color}">${r.val}</td>
      <td class="td-muted">${r.valReal !== '—' ? r.valReal + ' (ceny 2024)' : '—'}</td>
    </tr>
  `).join('');
  ctx.style.display = 'block';
}


// ══════════════════════════════════════════════════════
// TAB 5: PRŮMĚR vs. MEDIÁN
// ══════════════════════════════════════════════════════
let chartMedian = null;

function renderMedian() {
  const years = YEARS_MEDIAN;
  const avgCista = years.map(y => hrubaToCista(y, MZDA[y] || 0));
  const medCista = years.map(y => hrubaToCista(y, MEDIAN_HRUBO[y]));
  const pct = years.map((y,i) => avgCista[i] > 0 ? +(medCista[i]/avgCista[i]*100).toFixed(1) : null);

  if (chartMedian) chartMedian.destroy();
  const cv = document.getElementById('chartMedian');
  chartMedian = new Chart(cv, {
    data: {
      labels: years.map(String),
      datasets: [
        {
          type: 'line',
          label: 'Čistá průměrná mzda',
          data: avgCista,
          borderColor: 'rgba(124,106,245,0.9)',
          backgroundColor: 'rgba(124,106,245,0.06)',
          borderWidth: 2, fill: true, tension: 0.3,
          pointRadius: 3, pointHoverRadius: 6,
          yAxisID: 'y',
        },
        {
          type: 'line',
          label: 'Čistá mediánová mzda',
          data: medCista,
          borderColor: 'rgba(232,197,71,0.9)',
          backgroundColor: 'rgba(232,197,71,0.06)',
          borderWidth: 2, fill: true, tension: 0.3,
          pointRadius: 3, pointHoverRadius: 6,
          yAxisID: 'y',
        },
        {
          type: 'line',
          label: 'Medián jako % průměru',
          data: pct,
          borderColor: 'rgba(122,128,153,0.6)',
          borderWidth: 1.5, borderDash: [4,3],
          pointRadius: 2, fill: false, tension: 0.3,
          yAxisID: 'y2',
        },
      ]
    },
    options: {
      responsive: true, maintainAspectRatio: true,
      interaction: { mode: 'index', intersect: false },
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: '#14171f', borderColor: '#252a3a', borderWidth: 1,
          titleColor: '#e8e4d8', bodyColor: '#7a8099',
          titleFont: { family: 'DM Mono', size: 11 },
          bodyFont: { family: 'DM Mono', size: 11 },
          callbacks: {
            label: ctx => {
              if (ctx.parsed.y === null) return null;
              if (ctx.datasetIndex === 2) return '  Medián/průměr: ' + ctx.parsed.y.toFixed(1).replace('.',',') + ' %';
              return '  ' + ctx.dataset.label + ': ' + ctx.parsed.y.toLocaleString('cs-CZ') + ' Kč';
            }
          }
        }
      },
      scales: {
        x: { grid: { color: 'rgba(37,42,58,0.4)' }, ticks: { color: '#7a8099', font: { family: 'DM Mono', size: 9 }, maxRotation: 45 }, border: { color: 'rgba(37,42,58,0.8)' } },
        y: { grid: { color: 'rgba(37,42,58,0.4)' }, ticks: { color: '#7a8099', font: { family: 'DM Mono', size: 9 }, callback: v => v.toLocaleString('cs-CZ') + ' Kč' }, border: { color: 'rgba(37,42,58,0.8)' }, position: 'left' },
        y2: { grid: { display: false }, ticks: { color: 'rgba(122,128,153,0.6)', font: { family: 'DM Mono', size: 9 }, callback: v => v.toFixed(0) + ' %' }, border: { color: 'transparent' }, position: 'right', min: 60, max: 100 },
      }
    }
  });

  // Table
  const tbody = document.getElementById('tableMedian');
  tbody.innerHTML = '';
  [...years].reverse().forEach(y => {
    const mzAvg = MZDA[y] || 0;
    const mzMed = MEDIAN_HRUBO[y];
    const ciAvg = hrubaToCista(y, mzAvg);
    const ciMed = hrubaToCista(y, mzMed);
    const ratio = ciAvg > 0 ? ciMed/ciAvg*100 : 0;
    const diff = ciAvg - ciMed;
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="td-year">${y}</td>
      <td class="td-mzda">${mzAvg.toLocaleString('cs-CZ')}</td>
      <td class="td-cista">${ciAvg.toLocaleString('cs-CZ')}</td>
      <td class="td-muted">${mzMed.toLocaleString('cs-CZ')}</td>
      <td style="color:var(--accent)">${ciMed.toLocaleString('cs-CZ')}</td>
      <td class="td-nahrada">${fmtPct(ratio)}</td>
      <td class="td-muted">${diff > 0 ? '+' : ''}${diff.toLocaleString('cs-CZ')}</td>
    `;
    tbody.appendChild(tr);
  });
}

// ══════════════════════════════════════════════════════
// HELPERS
// ══════════════════════════════════════════════════════
function chartOpts(yLabel, tooltipFmt) {
  return {
    responsive: true,
    maintainAspectRatio: true,
    interaction: { mode: 'index', intersect: false },
    plugins: {
      legend: { display: false },
      tooltip: {
        backgroundColor: '#14171f', borderColor: '#252a3a', borderWidth: 1,
        titleColor: '#e8e4d8', bodyColor: '#7a8099',
        titleFont: { family: 'DM Mono', size: 11 },
        bodyFont: { family: 'DM Mono', size: 11 },
        callbacks: {
          label: ctx => {
            if (ctx.parsed.y === null) return null;
            return `  ${ctx.dataset.label}: ${tooltipFmt(ctx.parsed.y)}`;
          }
        }
      }
    },
    scales: {
      x: {
        grid: { color: 'rgba(37,42,58,0.4)' },
        ticks: { color: '#7a8099', font: { family: 'DM Mono', size: 9 }, maxRotation: 45 },
        border: { color: 'rgba(37,42,58,0.8)' }
      },
      y: {
        grid: { color: 'rgba(37,42,58,0.4)' },
        ticks: { color: '#7a8099', font: { family: 'DM Mono', size: 9 }, callback: tooltipFmt },
        border: { color: 'rgba(37,42,58,0.8)' }
      }
    }
  };
}

function switchTab(name, btn) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById('panel-' + name).classList.add('active');
  btn.classList.add('active');
}

init();
</script>
</body>
</html>
